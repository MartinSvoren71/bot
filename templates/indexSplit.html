v1.5
<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Knowledge Vortex Bot</title>
      <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
      <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.70/pdfmake.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.70/vfs_fonts.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.0/jspdf.umd.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
      <script>
         window.onload = function() {
             const saveFolder = localStorage.getItem("folder-selector");
             if (saveFolder) {
                 document.getElementById("folder-selector").value = saveFolder;
             }
         };
                 
          setInterval(function() {
            // Code to refresh the log container
            loadLogFile();
              
          }, 5000);
                  
          function updateTime() {
                      var now = new Date();
                      var time = now.toLocaleTimeString();
                      var date = now.toLocaleDateString();
                      document.getElementById('datetime').innerHTML = time + ' on ' + date;
                  }
                  setInterval(updateTime, 1000); 
             
          const form = document.getElementById('submit-button');
          form.addEventListener('submit', (event) => {
          event.preventDefault(); // prevent default form submission
          // handle form submission here
          });
          
          // Listen for Enter key press on input field
          const inputField = form.querySelector('input[name="input-field"]');
          inputField.addEventListener('keydown', (event) => {
          if (event.key === 'Enter') {
          event.preventDefault(); // prevent Enter key from creating a new line
          form.submit(); // submit the form
          }
          });
      </script>
      <title>Ask AI</title>
      <style>
         :root {
         --matrix-white-1:                #ffffff;
         --matrix-red-1:                  #ff000c;
         --matrix-red-2:                  #6b0c08;  
         --matrix-green-1:                #ffffff;
         --matrix-green-2:                #2d9cca;
         --matrix-green-3:                #5a8662;
         --matrix-green-4:                #2d9cca;
         --matrix-blue-pill:                #a9abb8;
         --matrix-red-pill:                #a9abb8;        
         --matrix-green-6:                #0e1c0d;  
         --matrix-amber-1:                 #a9abb8;
         --matrix-amber-2:                 #ffdd9d;
         --matrix-black-1:                  #081717;      
         --matrix-black-2:                   black;    
         --text-1:                       #1cafec;
         --text-2:                          #474866
         --gray-2:                        #29658a;    
         --matrix-gray-1:                 #1f1f1f;
         --title-grad:     radial-gradient(circle, rgba(12, 29, 29, 0.35) 0%, rgba(8, 23, 23, 0.5) 100%);
             
             
             
         font-family: 'Lucida Console', monospace;  
         max-width: 100vw;
         width: 100vw;
         }     
         /* Style for the title text */
         .title {
         color: white;
         font-size: 2rem;
         text-align: center;
         height: 6vh;
         background: var(--title-grad);
         opacity: 0.7;
         display: fixed;
         justify-content: center;
         align-items: center;
         margin-top: 0px;
         display: flex;
         justify-content: center;
         align-items: center;
         position: flex;
         top: 0;
         left: 0;
         right: 0;
         filter: drop-shadow(0 0 0.25rem black);
         }
         #container {
         color: var(--matrix-black-1);
         font-family: 'Lucida Console', monospace;  
         display: flex;
         height: auto;
         justify-content: center;
         }
         #container2 {
         font-family: 'Lucida Console', monospace;  
         height: 50vh;
         display: flex;
         margin-bottom:1vh;
         justify-content: center;
         }
         #container3 {
         font-family: 'Lucida Console', monospace;  
         display: flex;
         height: 100vh;
         align-items: center;
         margin-bottom:1vh;
         justify-content: center;
         align-items: center;
         display: flex;
         }
         #container4 {
         padding-top:10vh;
         font-family: 'Lucida Console', monospace;  
         align-items: center;
         justify-content: center;
         align-items: center;
         display: flex;
         max-height: 60vh;
         height: 60vh;
         }
         .footer {
         padding:100px;  
         }
         .flex-container {
         font-family: 'Lucida Console', monospace;  
         display: flex;
         flex-direction: row;
         }
         .flex-container > div {
         flex: 1;
         }
         .quill-container {
         width: 100%; /* You can adjust the width as needed */
         font-family: 'Lucida Console', monospace;  
         height: 112.5vh;
         background-color: var(--matrix-white-1);
         font-size: 1.3em;
         font-weight: bold;
         border: none;
         margin: 0 ; /* Center the container horizontally */
         color: var(--matrix-black-2);
         opacity:0.7;
         }
         .ql-container.ql-snow {
         border: none;
         }
         .quill-editor img {
         max-width: 20%;
         height: auto;
         }
         .content-wrapper {
         font-family: 'Lucida Console', monospace;  
         flex: 1;
         position: top;
         display: flex;
         flex-direction: column;
         align-items: center;
         justify-content: up;
         width: 48%;
         max-width: 48%;
         }
         .right-side {
         top: 0;
         right: 0;
         flex: 1;
         max-height: 100vh;
         display: fixed;
         justify-content: center;
         align-items: center;
         max-width: 42%;
         width: 42%;
         background: var(--title-grad);
                  padding:3%;

         }
         .right-side::-webkit-scrollbar {
         width: 6px;
         }
         .right-side::-webkit-scrollbar-track {
         background-color: #333;
         }
         .right-side::-webkit-scrollbar-thumb {
         background-color: #666;
         border-radius: 3px;
         }
         .right-side::-webkit-scrollbar-thumb:hover {
         background-color: #555;
         }
         .left-side {
         top: 0;
         left:0;
         flex: 1;
         display: fixed;
         justify-content: center;
         align-items: center;
         max-width: 50%;
         width: 50%;
         }
         .left-down-side {
         top: 100vh;
         left:0;
         padding:3%;
         flex: 1;
         justify-content: center;
         align-items: center;
         max-width: 48%;
         width: 48%;
         max-width: 80%;
         height:80vh;
         background: var(--title-grad);
         color: var(--matrix-red-pill);
         border-right: 1px solid #19192e;
         border-bottom: 1px solid #19192e;
         flex-direction: column;
         overflow-y: auto;
         overflow-x: hidden; /* Add this line */
         }
         .left-down-side::-webkit-scrollbar {
         width: 6px;
         }
         .left-down-side::-webkit-scrollbar-track {
         background-color: #333;
         }
         .left-down-side::-webkit-scrollbar-thumb {
         background-color: #666;
         border-radius: 3px;
         }
         .left-down-side::-webkit-scrollbar-thumb:hover {
         background-color: #555;
         }
         .right-down-side {
         top: auto;
         right:0;
                  padding:3%;

         max-width: 48%;
         width: 48%;
         flex: 1;
         color: var(--matrix-green-1);
         justify-content: center;
         align-items: center;
         max-width: 80%;
         flex-direction: column;
         overflow-y: auto;
         height:80vh;
         background: var(--title-grad);
         border-bottom: 1px solid #19192e;
         }
         .right-down-side::-webkit-scrollbar {
         width: 6px;
         }
         .right-down-side::-webkit-scrollbar-track {
         background-color: #333;
         }
         .right-down-side::-webkit-scrollbar-thumb {
         background-color: #666;
         border-radius: 3px;
         }
         .right-down-side::-webkit-scrollbar-thumb:hover {
         background-color: #555;
         }
         .left-down-down-side {
         top: auto;
         left:0;
         flex: 1;
         display: fixed;
         justify-content: left;
         align-items: center;
         max-width: 48%;
         width: 48%;
         height: 120vh;
                  padding:3%;

         background: var(--title-grad);
         color: var(--matrix-black-1);
         border-right: 1px solid #19192e;
         }
         .left-down-down-side::-webkit-scrollbar {
         width: 6px;
         }
         .left-down-down-side::-webkit-scrollbar-track {
         background-color: #333;
         }
         .left-down-down-side::-webkit-scrollbar-thumb {
         background-color: #666;
         border-radius: 3px;
         }
         .left-down-down-side::-webkit-scrollbar-thumb:hover {
         background-color: #555;
         }
         .right-down-down-side {
         top: auto;
         right:0;
         flex: 1;
         display: fixed;
         justify-content: center;
         align-items: center;
         max-width: 48%;
         opacity:0.7;
         width: 48%;
         height: 120vh;
                  padding:3%;

         background: var(--title-grad);
         }
         .right-down-down-side::-webkit-scrollbar {
         width: 6px;
         }
         .right-down-down-side::-webkit-scrollbar-track {
         background-color: #333;
         }
         .right-down-down-side::-webkit-scrollbar-thumb {
         background-color: #666;
         border-radius: 3px;
         }
         .right-down-down-side::-webkit-scrollbar-thumb:hover {
         background-color: #555;
         }
         .left-down-down-down-side {
         top: auto;
         left:0;
         flex: 1;
         display: fixed;
         justify-content: left;
         align-items: center;
         opacity:0.7;
         max-width: 48%;
         width: 48%;
         max-height: 80vh;
         height: 80vh;
         }
         .left-down-down-down-side::-webkit-scrollbar {
         width: 6px;
         }
         .left-down-down-down-side::-webkit-scrollbar-track {
         background-color: #333;
         }
         .left-down-down-down-side::-webkit-scrollbar-thumb {
         background-color: #666;
         border-radius: 3px;
         }
         ..left-down-down-down-side::-webkit-scrollbar-thumb:hover {
         background-color: #555;
         }
         .middle-side {
         top: auto;
         right:0;
         flex: 1;
         display: fixed;
         justify-content: center;
         align-items: center;
         opacity: 0.0;
         max-width: 4%;
         width: 4%;
         max-height: 80vh;
         height: 80vh;
         }
         .right-down-down-down-side::-webkit-scrollbar {
         width: 6px;
         }
         .right-down-down-down-side {
         top: auto;
         right:0;
         flex: 1;
         display: fixed;
         justify-content: center;
         align-items: center;
         max-width: 48%;
         opacity:0.7;
         width: 48%;
         max-height: 80vh;
         height: 80vh;
         }
         .right-down-down-down-side::-webkit-scrollbar {
         width: 6px;
         }
         .right-down-down-down-side::-webkit-scrollbar-track {
         background-color: #333;
         }
         .right-down-down-down-side::-webkit-scrollbar-thumb {
         background-color: #666;
         border-radius: 3px;
         }
         .right-down-down-down-side::-webkit-scrollbar-thumb:hover {
         background-color: #555;
         }
         .bottom {
         flex: 1;
         display: fixed;
         justify-content: left;
         align-items: center;
         max-width: 50%;
         height: 120vh;
         max-height: 500vh;
         color: var(--matrix-black-1);
         }       
         body {
         font-family: 'Lucida Console', monospace;  
         color: var(--matrix-black-1);
         margin: 0;
         padding:0;
         background-color: var(--matrix-black-1);
         font-size: 0.9em;
         font-weight: bold;
         margin:left: 3%;
         margin:right: 3%;
         justify-content: center;
         align-items: center;
         overflow-x: hidden; /* Add this line */
         overflow-y: scroll;    
         }
         body::-webkit-scrollbar {
         width: 6px;
         }
         body::-webkit-scrollbar-track {
         background-color: #333;
         }
         body::-webkit-scrollbar-thumb {
         background-color: #666;
         border-radius: 3px;
         }
         body::-webkit-scrollbar-thumb:hover {
         background-color: #555;
         }
         canvas {
         width: 100vw;
         z-index: -1;
         opacity: 0;
         position: fixed;
         top: 0%;
         left: 0%;
         padding-top: 0px;
         height:100vh;    
         filter: drop-shadow(0 0 0.9rem red);
         } 
         @keyframes pulse {
         0% {
         filter: drop-shadow(0 0 0.2rem yellow);
         transform: translate(0px, 0px);
         }
         12% {
         filter: drop-shadow(0 0 0.4rem yellow);
         transform: translate(0px, 0px);
         }
         23% {
         filter: drop-shadow(0 0 0.5rem orange);
         transform: translate(0px,0px);
         }
         35% {
         filter: drop-shadow(0 0 0.6rem red);
         transform: translate(0px, 0px);
         }
         41% {
         filter: drop-shadow(0 0 0.4rem green);
         transform: translate(0px, 0px);
         }
         49% {
         filter: drop-shadow(0 0 0.8rem green);
         transform: translate(0px, 0px);
         }
         66% {
         filter: drop-shadow(0 0 0.6rem red);
         transform: translate(0px, 0px);
         }
         100% {
         filter: drop-shadow(0 0 0.5rem orange);
         transform: translate(0px, 0px);
         }
         }
         img {
         width: 100%;
         height: auto;
         max-width: 220px;
         opacity: 0.85;
         display: block;
         margin: 0 auto;
         margin-bottom: 50px;
         filter: drop-shadow(0 0 0.85rem red);
         animation: pulse 8s infinite; /* Apply the pulse animation, and make it faster (1.5s) */
         }
         #footer_image {
         width: 35vw;
         height: auto;
         display: flex;
         margin-top: 3%;
         margin-bottom: 1%;
         filter: drop-shadow(0 0 0.75rem green);   
         }
         #log-container {
         padding: 2%;
         font-family: 'Lucida Console', monospace;  
         width: 96%;
         max-width: 96%;
         height: 90%;
         overflow-x: hidden;
         flex-direction: column;
         overflow-y: auto;
         var(--matrix-green-1);
         font-size: 0.9em;
         font-weight: bold;
         white-space: pre-wrap;
         color: var(--matrix-green-1);   
         }
         .log-container::-webkit-scrollbar {
         width: 6px;
         }
         .log-container::-webkit-scrollbar-track {
         background-color: #333;
         }
         .log-container::-webkit-scrollbar-thumb {
         background-color: #666;
         border-radius: 3px;
         }
         .log-container::-webkit-scrollbar-thumb:hover {
         background-color: #555;
         }
         #select-container-2{
         margin-top:2%;
         margin-bottom:0%;
         }
         #log-container::-webkit-scrollbar {
         display: none;
         }
         h1 {
         max-width: 100%;
         font-size: 1.5em;
         text-align: center;
         filter: drop-shadow(0 0 0.35rem var(--matrix-red-pill));
         color: var(--matrix-green-1);
         }
         h2 {
         max-width: 100%;
         font-size: 1.2em;
         text-align: center;
         filter: drop-shadow(0 0 0.35rem var(--matrix-red-pill));
         color: var(--matrix-green-1);
         }
         h3 {
         max-width: 100%;
         font-size: 1em;
         text-align: center;
         filter: drop-shadow(0 0 0.35rem var(--matrix-red-pill));
         color: var(--matrix-green-1);
         }
         h4 {
         max-width: 100%;
         font-size: 0.8em;
         text-align: center;
         filter: drop-shadow(0 0 0.35rem var(--matrix-green-1));
         color: var(--matrix-green-2);
         }
         a {
         max-width: 100%;
         font-size: 1.0em;
         text-align: center;
         color: var(--matrix-blue-pill);
         }
         .folder-content{
         flex-direction: column;
         overflow-y: auto;
         max-height: 70vh;   
         white-space: pre-wrap;
         }
         p {
         max-width: 100%;
         font-size: 1em;
         text-align: center;
         color: var(--matrix-black-1);
         filter: drop-shadow(0 0 0.35rem var(--matrix-green-1));
         }
         form {
         margin: 0 ;
         display: flex;
         flex-direction: column;
         justify-content: center;
         align-items: center;
         }
         label {
         font-size: 1.2em;
         }
         textarea {
         font-family: 'Lucida Console', monospace;  
         font-size: 1.1em;
         margin: 0px;
         border: none;
         outline: none;
         background-color: rgba(0, 0, 0, 0.5);
         color: var(--matrix-red-pill);
         justify-content: center;
         align-items: center;
         margin: 2% ;
         filter: drop-shadow(0 0 0.35rem green);
         text-align: left;
         padding: 5px;
         width: 100%; /* Adjust this to the desired width */
         min-height: 20vh; /* Adjust this to the desired minimum height */
         resize: vertical; /* Allow vertical resizing */
         }
         .out_text  {
         font-family: 'Lucida Console', monospace;  
         font-size: 1.1em;
         margin: 0px;
         border: none;
         outline: none;
         background-color: rgba(0, 0, 0, 0.5);
         color: var(--matrix-red-pill);
         justify-content: center;
         align-items: center;
         margin: 4% auto;
         filter: drop-shadow(0 0 0.35rem green);
         text-align: left;
         padding: 10px;
         width: 100%; /* Adjust this to the desired width */
         height: 90vh; /* Adjust this to the desired minimum height */
         resize: vertical; /* Allow vertical resizing */
         }     
         input[type="text"] {
         font-family: 'Lucida Console', monospace;  
         font-size: 1.1em;
         margin: 0px;
         border: none;
         outline: none;
         background-color: rgba(0, 0, 0, 0.5);
         color: var(--matrix-red-pill);
         justify-content: center;
         align-items: center;
         margin: 1% ;
         filter: drop-shadow(0 0 0.35rem green);
         text-align: left;
         padding: 10px;
         width: 100%; /* Adjust this to the desired width */
         }
         .button-wrapper {
         display: flex;
         justify-content: center;
         width: 100%;
         }
         out_text{
         width: 100%;
         height: 100%;
         background-color: rgba(0, 0, 0, 0.2);
         color: var(--matrix-green-1);
         font-size: 1.1em;
         font-weight: bold;
         white-space: pre-wrap;
         }
         #button-search {
         font-size: 1.3em;
         padding: 10px;
         border-radius: 8px;
         margin-top: 15px;
         border: none;
         outline: none;
         background-color: var(--matrix-amber-1);
         color: var(--matrix-black-1);
         cursor: pointer;
         filter: drop-shadow(0 0 0.15rem red);
         }
         #button {
         font-size: 1.1em;
         padding: 10px;
         border-radius: 3px;
         margin-top: 3px;
         border: none;
         outline: none;
         background-color: var(--matrix-amber-1);
         color: var(--matrix-black-1);
         cursor: pointer;
         filter: drop-shadow(0 0 0.15rem red);
         }
         #button-GPT {
         font-size: 1.3em;
         padding: 10px;
         border-radius: 8px;
         margin-top: 15px;
         border: none;
         outline: none;
         background-color: var(--matrix-red-pill);
         color: var(--matrix-black-1);
         cursor: pointer;
         filter: drop-shadow(0 0 0.15rem red);
         }
         ask-form {
         }
         #button-AI {
         font-size: 1.3em;
         padding: 10px;
         border-radius: 8px;
         margin-top: 15px;
         border: none;
         outline: none;
         background-color: var(--matrix-blue-pill);
         color: var(--matrix-black-1);
         cursor: pointer;
         filter: drop-shadow(0 0 0.15rem cyan);
         }
         #button-search:hover {
         background-color: var(--matrix-amber-1);
         filter: drop-shadow(0 0 0.55rem var(--matrix-amber-1));
         }
         #button-AI:hover {
         background-color: cyan;
         filter: drop-shadow(0 0 0.55rem cyan);
         }
         #button-GPT:hover {
         background-color: red;
         filter: drop-shadow(0 0 0.55rem red);
         }
         .input-key {
         font-size: 1.2em;
         padding: 5px;
         border-radius: 10px;
         border: none;
         outline: none;
         background-color: var(--matrix-gray-1);    
         color: var(--matrix-red-pill));
         }
         document {
         padding: 0px;
         width: 30%;
         height: 800px;
         }
         .file-list-container {
         padding: 0;
         margin-top: 15px;
         width: auto;
         }
         .container {
         display: flex;
         }
         .list-container {
         color: var(--matrix-green-1));
         margin-bottom: 3%;
         max-height: 70vh;
         font-family: 'Lucida Console', monospace;  
         text-align: left;
         width: 100vw; /* Adjust this to the desired width */
         max-height: 60vh; /* Adjust this to the desired minimum height */
         resize: vertical; /* Allow vertical resizing */
         max-width: auto;
         flex-direction: column;
         overflow-y: scroll;
         }
         .list-container::-webkit-scrollbar {
         width: 0.2em; /* Set the width of the scrollbar */
         }
         .list-container::-webkit-scrollbar-track {
         background-color: transparent; /* Set the background color of the track to transparent */
         }
         .list-container::-webkit-scrollbar-thumb {
         background-color: transparent; /* Set the background color of the thumb to transparent */
         }
         a {
         color: var(--matrix-red-pill));
         text-decoration: none;
         }
         li a {
         font-size: 1.em;
         margin: 3px;
         padding: 3px;
         color: #5a8662;
         }
         ul {
         margin: 3px;
         padding: 3px;
         }
         ul li {
         border: 0.2px ridge #173a3a;   
         border-radius: 3px;
         margin: 6px;
         padding: 3px;
         }
         #question {
         margin: 1% auto;
         filter: drop-shadow(0 0 0.75rem white);
         color: var(--matrix-green-1);
         width:100%;
         height: 5vh;
         } 
         #keyword {
         margin: 1% auto;
         filter: drop-shadow(0 0 0.75rem white);
         color: var(--matrix-green-1);
         width:70%;
         height: 5vh;
         } 
         a:hover {
         color: #aaa;
         }
         .list-container {
         width: 50vw;
         overflow: hiden;
         }
         .pdf-container{
         width: 50vw;
         overflow: hiden;
         opacity: 0.4;
         }
         #folder-selector {
         padding: 1%;
         border-radius: 4px;
         outline: none;
         background-color: var(--matrix-green-3);
         color: var(--matrix-black-1));
         cursor: pointer;
         font-size: 1.0em;
         filter: drop-shadow(0 0 0.35rem var(--matrix-amber-1));
         }
         #folder-selector option {
         font-size: 1.1em;
         padding: 8px 12px;
         border-radius: 4px;
         border: none;
         outline: none;
         background-color: var(--matrix-anber-1);;
         color: var(--matrix-black-1));
         cursor: pointer;
         }
         #folder-selector option:hover {
         background-color: var(--matrix-green-1);
         background-color: var(--matrix-green-3);
         }
         #folder-selector:focus,
         #folder-selector:active {
         border-color: var(--matrix-red-1);
         }
         folder-selector
         #model {
         padding: 1%;
         border-radius: 4px;
         border: 1px solid var(--matrix-red-1);
         outline: none;
         background-color: var(--matrix-green-1);
         cursor: pointer;
         color: var(--matrix-black-1));
         font-size: 1.2em;
         }
         #model option {
         font-size: 1.3em;
         padding: 8px 12px;
         border-radius: 4px;
         border: none;
         outline: none;
         background-color: var(--matrix-green-1);;
         color: var(--matrix-black-1));
         cursor: pointer;
         }
         #model option:hover {
         background-color: var(--matrix-green-1);
         }
         #model:focus,
         #model:active {
         border-color: var(--matrix-red-1);
         }
         results {
         width: 100%;
         padding:5%;
         height: 90%;
         background-color: rgba(0, 0, 0, 0.2); 
         color: var(--matrix-green-1));
         font-family: 'Lucida Console', monospace;
         max-height: 80vh;  
         white-space: pre-wrap;
         }
         results::-webkit-scrollbar {
         width: 6px;
         }
         results::-webkit-scrollbar-track {
         background-color: #333;
         }
         results::-webkit-scrollbar-thumb {
         background-color: #666;
         border-radius: 3px;
         }
         results::-webkit-scrollbar-thumb:hover {
         background-color: #555;
         } 
         #loader {
         border: 16px solid #a31c1c;
         border-top: 16px solid #050404;
         border-radius: 50%;
         width: 80px;
         height: 80px;
         animation: spin 1s linear infinite;
         }
         #loader2 {
         border: 16px solid #a31c1c;
         border-top: 16px solid #050404;
         border-radius: 50%;
         width: 80px;
         height: 80px;
         animation: spin 1s linear infinite;
         }
         @keyframes spin {
         0% { transform: rotate(0deg); }
         100% { transform: rotate(360deg); }
         }
         #slider-wrapper {
         margin-top: 20px;
         padding: 10px; /* Add padding to the slider container */
         display: fixed;
         justify-content: center;
         align-items: center;
         }
         input[type=range] {
         -webkit-appearance: none; /* Remove default appearance for WebKit browsers */
         width: 30%;
         background: transparent; /* Remove default background */
         opacity: 0.5;
         display: fixed;
         justify-content: center;
         align-items: center;
         }
         input[type=range]::-webkit-slider-thumb {
         -webkit-appearance: none;
         width: 12px;
         height: 12px;
         background: lightgreen;
         cursor: pointer;
         border-radius: 10px;
         opacity: 0.8;
         }
         input[type=range]::-moz-range-thumb {
         width: 12px;
         height: 12px;
         background: lightgreen;
         cursor: pointer;
         border-radius: 10px;
         opacity: 0.8;
         }
         /* Slider track styles */
         input[type=range]::-webkit-slider-runnable-track {
         width: 30%;
         height: 4px;
         background: lightgreen;
         cursor: pointer;
         border-radius: 4px;
         opacity: 0.5;
         }
         input[type=range]::-moz-range-track {
         width: 30%;
         height: 4px;
         background: lightgreen;
         cursor: pointer;
         border-radius: 4px;
         opacity: 0.5;
         }
      </style>
      <h1 class="title">Knowledge-Vortex</h1>
   </head>
   <body onsubmit="event.preventDefault();" onclick="event.preventDefault();">
      <canvas id="matrixCanvas"></canvas>
      <div class="container">
         <div class="content-wrapper">
            <div class="left-side">
               <h1>__Knowledge Vortex__</h1>
               <img src="https://knowledgevortex.s3.eu-north-1.amazonaws.com/logo1+(1).png" alt="KV Logo">
               <h2 id="datetime" style="color: red;"></h2>
               <div>
                  <h4>__opacity__</h4>
               </div>
               <div style="display: flex; justify-content: center; align-items: center;">
                  <button onclick="light(event)" id="light_theme" >LIGHT</button>
                  <input type="range" id="opacity-slider" min="0" max="100" value="70">
                  <button onclick="dark(event)" id="dark_theme">DARK</button>
               </div>
               <h3>ask operator: </h3>
               <form id="ask-form" enctype="multipart/form-data" >
                  <textarea name="question" id="question" placeholder="How can I help?"required></textarea>
                  <div id="loader2" style="display:none;width:20px;height:20px;"></div>
                  <div>
                     <button style="buttonGPT" id="button-GPT" onclick="ask_GPT(event)">request on public data </button>
                     <button style="buttonAI" id="button-AI" onclick="ask_LIB(event)">request on my data</button>  
                  </div>
                  <h2 >library:</h2>
                  <div class="select-container-2" id="select-container-2">
                     <select name="folder-selector" id="folder-selector" onchange="saveFolderx()">
                        {% for folder in folders %}
                        <option value="{{ folder }}">{{ folder }}</option>
                        {% endfor %}
                     </select>
                  </div>
                  <pre id="console-output" style="white-space: pre-wrap;"></pre>
                  <h1>__vortex keyword search__</h1>
               <form id="search-form">
                  <input type="text" id="keyword" name="keyword" placeholder="Enter keyword">
                  <div id="loader" style="display:none;width:20px;height:20px;"></div>
                  <button id="button-search" type="button" onclick="searchFiles()">Search</button>
               </form>
            </div>
         </div>
         <div class=" middle-side">
         </div>
         <div class="right-side">
            <div>
               <h1>__vortex operator chat__</h1>
            </div>
            <div id="log-container"></div>
         </div>
      </div>
      <div class="container flex-container" style="container2">
         <div class="left-down-side">
            <div>
               <h1>__vortex file bucket__</h1>
               <div class="list-container">
               </div>
               <ul id="folder-content"></ul>
            </div>
         </div>
         <div class=" middle-side">
         </div>
         <div class="right-down-side">
            <div>
               <h1>__vortex search resoults__</h1>
            </div>
            <div class="results" id="results">
            </div>
         </div>
      </div>
      <div class="container flex-container" style="container3">
         <div class="left-down-down-side">
            <h1>__create new document__</h1>
            <div class="quill-container">
               <button id="button" type="button" onclick="save_doc()">Save</button>
               <div id="quill-editor"></div>
               <input type="hidden" name="content" id="content">
            </div>
         </div>
         <div class=" middle-side">
         </div>
         <div class="right-down-down-side">
            <h1>__vortex pdf preview__</h1>
            <div class="pdf-viewer">
               <embed id="pdf-embed" src="" type="application/pdf" width="100%" height="94%">
            </div>
         </div>
      </div>
      </div>
      <div class="container flex-container" style="container4">
         <div class="left-down-down-down-side">
            <h1>__vortex sketch pad__</h1>
            <iframe src="https://knowledgevortex.s3.eu-north-1.amazonaws.com/index.html" width="100%" height="100%" frameborder="0"></iframe>
         </div>
         <div class=" middle-side">
         </div>
         <div class=" right-down-down-down-side">
            <h1>__vortex mind map__</h1>
            <iframe src="https://www.mindmaps.app/" width="100%" height="100%" frameborder="0"></iframe>
         </div>
      </div>
      <div class="footer">
         <h3>Knowledge Vortex 2023</h3>
         <div>
         </div>
      </div>
   </body>
   <script>
      function openPdf(presignedUrl) {
      console.log('Presigned URL:', presignedUrl);
      let pdfEmbed = document.getElementById('pdf-embed');
      pdfEmbed.setAttribute('src', presignedUrl);
      }
      
      
      function loadLogFile() {
      const logContainer = document.getElementById('log-container');
      
      fetch('/log-content')
      .then(response => response.text())
      .then(data => {
      logContainer.innerHTML = data;
      })
      .catch(error => {
      console.error('Error fetching log.txt:', error);
      });
      }
      
      loadLogFile();
             
      
       function saveFolderx() {
       const saveFolder = document.getElementById("folder-select").value;
       localStorage.setItem("folder-select", saveFolder);
      }  
       
          
       
      async function ask_LIB(event) {
                  //  wait();
         wait2();
         event.preventDefault();
        const form = document.getElementById("ask-form");
        const formData = new FormData(form);
        const response =  fetch("/ask_lib", {
            method: "POST",
            body: formData,
        });
      } 
       async function ask_GPT(event) {
                    // wait();
      wait2();
        event.preventDefault();   
        const form = document.getElementById("ask-form");
        const formData = new FormData(form);
        const response =  fetch("/ask_gpt", {
            method: "POST",
            body: formData,
        });     
       }  
       
       
      async function save(event) {
      event.preventDefault();
      
      // Extract the HTML content from the Quill editor
      const content = quill.root.innerHTML;
      
      // Create a new div element and set its innerHTML to the extracted content
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = content;
      
      // Render the content div using html2canvas with an increased scale factor
      const scale = 3; // Increase the scale factor to improve resolution
      const canvas = await html2canvas(contentDiv, { scale });
      
      // Create a new jsPDF instance
      const pdf = new jsPDF('p', 'mm', 'a4');
      
      // Add the rendered canvas to the PDF
      const imgData = canvas.toDataURL('image/png');
      const imgProps = pdf.getImageProperties(imgData);
      const pdfWidth = pdf.internal.pageSize.getWidth();
      const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
      pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
      
      // Download the PDF
      pdf.save('download.pdf');
      }
      
       
      
       
      function searchFiles() {
      searchFiles_1();
          wait();
      let keyword = $('#keyword').val();
      let selectedFolder = $('#folder-selector').val();
      console.log("Sending data:", { keyword: keyword, folder_path: selectedFolder }); // Add this line
      $.post('/search_pdf_files', { keyword: keyword, folder_path: selectedFolder }, function (data) {
        $('#search-results').html(data.rendered_template);
        loader.style.display = "none";
      });
      }
      
      function searchFiles_1() {
      const keyword = $('#keyword').val();
      $.ajax({
        url: '/search_pdf_files',
        method: 'POST',
        data: {
            keyword: keyword,
        },
        success: function(data) {
            // Render the search results
            $('.results').html(data.rendered_template);
        },
        error: function(err) {
            console.log(err);
        }
      });
      }
       
       
      function showPDF(url) {
      document.getElementById('pdf-embed').src = '/lurl.pdf';
      setTimeout(() => {
        document.getElementById('pdf-embed').src = url;
      }, 300);
      }
       
        const canvas = document.getElementById('matrixCanvas');
         const ctx = canvas.getContext('2d');
         canvas.width = window.innerWidth;
         canvas.height = window.innerHeight;
         
      const characters = '゠ァアィイゥウェエォオカガキギクグケゲコゴサザシジスズセゼソゾタダチヂッツヅテデトドナニヌネノハバパヒビピフブプヘベペホボポマミムメモャヤュユョヨラリルレロヮワヰヱヲンヴヵヶヷヸヹヺ・ーヽヾゝゞー１２３４５６７８９０';
         
         const fontSize = 15;
         const columns = canvas.width / fontSize;
         
         const drops = [];
         for (let i = 0; i < columns; i++) {
         	drops[i] = 1;
         }
         
         function draw() {
         	ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
         	ctx.fillRect(0, 0, canvas.width, canvas.height);
         
         	ctx.fillStyle = '#a36e0a';
         	ctx.font = `${fontSize}px monospace`;
         
         	for (let i = 0; i < drops.length; i++) {
         		const text = characters.charAt(Math.floor(Math.random() * characters.length));
         		ctx.fillText(text, i * fontSize, drops[i] * fontSize);
         
         		if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
         			drops[i] = 0;
         		}
         		drops[i]++;
         	}
         }
         
         setInterval(draw, 33);
       
      // Initialize Quill editor
      var quill = new Quill('#quill-editor', {
      theme: 'snow'
      });
      
      async function save_doc() {
      // Get content from Quill editor
      const content = quill.root.innerHTML;
      
      // Create a temporary container for rendering
      const container = document.createElement('div');
      container.innerHTML = content;
      container.style.width = '8.5in';
      container.style.height = '11in';
      container.style.overflow = 'hidden';
      container.style.position = 'absolute';
      container.style.left = '-9999px';
      container.style.top = '-9999px';
      document.body.appendChild(container);
      
      // Render the content as an image using html2canvas
      const canvas = await html2canvas(container, { scale: 0.72 });
      
      // Remove the temporary container
      document.body.removeChild(container);
      
      // Convert the canvas to a data URL
      const imageDataUrl = canvas.toDataURL('image/png');
      
      // Get the current date and time
      const now = new Date();
      const dateString = now.toLocaleDateString();
      const timeString = now.toLocaleTimeString();
      
      // Define the PDF content using pdfmake
      const docDefinition = {
      header: {
      text: `generated by KV ${dateString} ${timeString}`,
      margin: [20, 20, 20, 20],
      style: 'header',
      },
      content: [
      {
        image: imageDataUrl,
        width: canvas.width * 0.85,
        height: canvas.height * 0.85,
      },
      {
      
      },
        {
      
      },
      ],
      pageMargins: [40, 60, 40, 60],
      styles: {
      header: {
        fontSize: 14,
        bold: true,
      },
      },
      };
      
      // Create a new pdfmake instance
      const pdfDoc = pdfMake.createPdf(docDefinition);
      
      // Save and download the PDF
      pdfDoc.download('document.pdf');
      }
      
      async function load_folders() {
      const response = await fetch('/list_folders');
      const folders = await response.json();
      const folderSelect = document.getElementById('folder-select');
      
      folders.forEach((folder) => {
      const option = document.createElement('option');
      option.value = folder;
      option.textContent = folder;
      folderSelect.appendChild(option);
      });
      }
      
      load_folders();
      
      function getFiles() {
      var folder = $('#folder-select').val();
      $.getJSON('/get_files/' + folder, function(data) {
        console.log(data); // Log the data received
        if (data.error) {
            console.error(data.error);
            return;
        }
        var files = data.files;
        $('#file-list').empty();
        for (var i = 0; i < files.length; i++) {
            $('#file-list').append('<li>' + files[i] + '</li>');
        }
      });
      }
      function updateFileList() {
        $.getJSON('/get_updated_files', function(data) {
            var files = data;
            var file_list_element = $('.list-container ul');
            file_list_element.empty();
            for (var i = 0; i < files.length; i++) {
                file_list_element.append('<li><a href="#" onclick="showPDF(\'' + files[i].PresignedURL + '\')">' + files[i].Key + '</a></li>');
            }
        });
      }  
       
       function updateFolderContent() {
        let selectedFolder = $('#folder-selector').val();
        $.post('/get_folder_content', {selected_folder: selectedFolder}, function(data) {
            $('#folder-content').html('');
            for (let item of data.folder_content) {
                let file_url = '/Data/' + selectedFolder + '/' + item;
                // Modify this line to call openPdf function with the Presigned URL
                $('#folder-content').append('<li><a href="#" onclick="openPdf(\'' + file_url + '\')">' + item + '</a></li>');
            }
        });
      }
      
       $('#folder-selector').on('change', updateFolderContent);
      updateFolderContent();
      function setCanvasOpacity() {
      let opacity = 0; // Start with an opacity of 0
      const increaseTime = 5000; // 8 seconds in milliseconds
      const targetOpacity = 0.45; // Change this to your desired opacity
      
      const increaseOpacity = () => {
        opacity += 0.01;
        canvas.style.opacity = opacity;
      
        if (opacity < targetOpacity) {
            setTimeout(increaseOpacity, increaseTime / 100);
        }
      };
      
      setTimeout(increaseOpacity, 0); // Set a delay before starting to increase the opacity
      }
      
      setCanvasOpacity();
       
      const quillContainer = document.querySelector('.quill-container');
      
      
      function wait() {
      var loader = document.getElementById("loader");
      loader.style.display = "block"; 
      }
      function wait2() {
      var loader = document.getElementById("loader2");
      loader.style.display = "block";
      setTimeout(function() {
      loader2.style.display = "none";
      }, 8000); // 8000 milliseconds = 8 seconds
      }
      document.addEventListener("DOMContentLoaded", function () {
      const slider = document.getElementById("opacity-slider");
      const containers = document.querySelectorAll(".right-down-down-down-side, .left-down-down-down-side, .right-down-down-side, .left-down-down-side, .quill-container, h4");
      
      slider.addEventListener("input", function () {
      const opacityValue = slider.value / 100;
      
      containers.forEach((container) => {
      container.style.opacity = opacityValue;
      });
      });
      });
       
async function dark(event) {
  event.preventDefault();
  const response = await fetch("/indexSplit");
  location.reload(); // Refresh the page after the response is received
}

async function light(event) {
  event.preventDefault();
  const response = await fetch("/indexSplit_light");
  location.reload(); // Refresh the page after the response is received
}
       
   </script>
</html>