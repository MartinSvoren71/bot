v1.5
<!DOCTYPE html>
<html lang="en">
   <head>
      <title>Knowledge Vortex Bot</title>
      <script>
         window.onload = function() {
             const savedTheme = localStorage.getItem("theme");
             if (savedTheme) {
                 document.getElementById("theme").value = savedTheme;
             }
         };
                 
          setInterval(function() {
            // Code to refresh the log container
            loadLogFile();
          }, 5000);
                  
          function updateTime() {
                      var now = new Date();
                      var time = now.toLocaleTimeString();
                      var date = now.toLocaleDateString();
                      document.getElementById('datetime').innerHTML = time + ' on ' + date;
                  }
                  setInterval(updateTime, 1000); 
             const form = document.getElementById('submit-button');
          form.addEventListener('submit', (event) => {
          event.preventDefault(); // prevent default form submission
          // handle form submission here
          });
          
          // Listen for Enter key press on input field
          const inputField = form.querySelector('input[name="input-field"]');
          inputField.addEventListener('keydown', (event) => {
          if (event.key === 'Enter') {
          event.preventDefault(); // prevent Enter key from creating a new line
          form.submit(); // submit the form
          }
          });
      </script>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Ask AI</title>
      <style>
          
          
          :root {
  --matrix-red-1:                  #ff000c;
  --matrix-red-2:                  #6b0c08;  
  --matrix-green-1:                #2d6e43;
  --matrix-green-2:                #295844;
  --matrix-green-3:                #295844;
  --matrix-green-5:                #0e1c0d;
  --matrix-blue-pill:                #0fc1c7;
  --matrix-red-pill:                #ff000c;        
  --matrix-green-6:                #0e1c0d;  
              --matrix-amber-1:   #997334;
              --matrix-amber-2:   #ffdd9d;
              font-family: 'Lucida Console', monospace;  
          }       
      
         
         .container {
         display: fixed;
         width: 98vw;
                  
         height: 99vh;
         margin-left:1vw;
         margin-right:1vw;
         margin-top:1vw;
         justify-content: center;
         }
         .content-wrapper {
         flex: 1;
         position: relative;
         display: flex;
         flex-direction: column;
         align-items: center;
         justify-content: center;
         overflow: hidden;
         }
         .right-side {
         top: 0;
         right: 0;
         flex: 1;
         display: flex;
         justify-content: center;
         align-items: center;
         max-width: 50%;
         border: 0.1px solid red;
         }
         .left-side {
         top: 0;
         left:0;
         flex: 1;
         display: fixed;
         justify-content: center;
         align-items: center;
         max-width: 50%;
         }
         .left-down-side {
         top: 100vh;
         left:0;
         flex: 1;
         display: fixed;
         justify-content: center;
         align-items: center;
         max-width: 50%;
         border: 0.1px solid red;
         }
         .right-down-side {
         top: 100vh;
         right:0;
         flex: 1;
         display: fixed;
         justify-content: center;
         align-items: center;
         max-width: 50%;
         border: 0.1px solid red;
         }
         .left-down-down-side {
         top: 200vh;
         left:0;
         flex: 1;
         display: fixed;
         justify-content: center;
         align-items: center;
         max-width: 50%;
         border: 0.1px solid red;
         }
         .right-down-down-side {
         top: 200vh;
         right:0;
         flex: 1;
         display: fixed;
         justify-content: center;
         align-items: center;
         max-width: 50%;
         border: 0.1px solid red;
       
         }
         body {
         margin: 0;
         background-color: black;
         color: #00FF00;
       
         font-size: 12px;
         font-weight: bold;
         overflow: scroll;
         justify-content: center;
         align-items: center;
         }
         canvas {
         width: 100vw;
         height: 100vh;
         z-index: -1;
         opacity: 0.35;
         position: fixed;
         top: 0%;
         left: 0%;
         padding-top: 0px;
         color: var(--matrix-green-1);
             filter: drop-shadow(0 0 0.95rem var(--matrix-red-pill));
         }
         img {
         width: 13vw;
         height: auto;
         max-width: 320px;
         display: block;
         margin: 4% auto;
         filter: drop-shadow(0 0 0.75rem green);
         }
         #footer_image {
         width: 35vw;
         height: auto;
         display: flex;
         margin-top: 1%;
         margin-bottom: 1%;
         filter: drop-shadow(0 0 0.75rem green);   
         }
         #log-container {
         width: 100%;
         height: 100%;
         background-color: rgba(0, 0, 0, 0.2);
         overflow-y: scroll;
         color: #00FF00;
         padding: 1%;
         font-size: 13px;
         font-weight: bold;
         white-space: pre-wrap;
         -ms-overflow-style: none;
         scrollbar-width: none;
         }
         #select-container-2{
         margin-top:2%;
         margin-bottom:0%;
         }
         #log-container::-webkit-scrollbar {
         display: none;
         }
         h1 {
         max-width: 100%;
         font-size: 1.5em;
         text-align: center;
                                     filter: drop-shadow(0 0 0.35rem var(--matrix-red-pill));
         }
         h2 {
         max-width: 100%;
         font-size: 1.2em;
         text-align: center;
                                     filter: drop-shadow(0 0 0.35rem var(--matrix-red-pill));
         }
         h3 {
         max-width: 100%;
         font-size: 1em;
         text-align: center;
                                     filter: drop-shadow(0 0 0.35rem var(--matrix-red-pill));
         }
         h4 {
         max-width: 100%;
         font-size: 0.8em;
         text-align: center;
         }
         form {
         margin: 2% auto;
         display: flex;
         flex-direction: column;
         justify-content: center;
         align-items: center;
             
         }
         label {
         font-size: 1.5em;
         margin-right: 20px;
         }
   textarea {
    font-size: 1.5em;
    margin: 0px;
    border: none;
    outline: none;
    background-color: rgba(0, 0, 0, 0.5);
    color: red;
    justify-content: center;
    align-items: center;
    margin: 4% auto;
    filter: drop-shadow(0 0 0.35rem green);
    text-align: left;
    padding: 10px;
    width: 100%; /* Adjust this to the desired width */
    min-height: 5vh; /* Adjust this to the desired minimum height */
    resize: vertical; /* Allow vertical resizing */
}
          
     out_text  {
    font-size: 1.5em;
    margin: 0px;
    border: none;
    outline: none;
    background-color: rgba(0, 0, 0, 0.5);
    color: red;
    justify-content: center;
    align-items: center;
    margin: 4% auto;
    filter: drop-shadow(0 0 0.35rem green);
    text-align: left;
    padding: 10px;
    width: 100%; /* Adjust this to the desired width */
    min-height: 5vh; /* Adjust this to the desired minimum height */
    resize: vertical; /* Allow vertical resizing */
}     
          
           input[type="text"] {
        font-size: 1.5em;
    margin: 0px;
    border: none;
    outline: none;
    background-color: rgba(0, 0, 0, 0.5);
    color: red;
    justify-content: center;
    align-items: center;
    margin: 4% auto;
    filter: drop-shadow(0 0 0.35rem green);
    text-align: left;
    padding: 10px;
    width: 100%; /* Adjust this to the desired width */
          
         }
         .button-wrapper {
         display: flex;
         justify-content: center;
         width: 100%;
         }
          
          out_text{
          width: 100%;
         height: 100%;
         background-color: rgba(0, 0, 0, 0.2);
         overflow-y: scroll;
         color: #00FF00;
     
         font-size: 13px;
         font-weight: bold;
         white-space: pre-wrap;
          }
         button {
         font-size: 1.6em;
         padding: 10px;
         border-radius: 8px;
         margin-top: 15px;
         border: none;
         outline: none;
         background-color: var(--matrix-green-1);
                                 filter: drop-shadow(0 0 0.35rem var(--matrix-amber-2));
         color: black;
         cursor: pointer;
         }
       buttonGPT {
         font-size: 1.6em;
         padding: 10px;
         border-radius: 8px;
         margin-top: 15px;
         border: none;
         outline: none;
         background-color: var(--matrix-red-pill);
         color: black;
         cursor: pointer;
                    filter: drop-shadow(0 0 0.35rem red);
         }
        buttonAI {
         font-size: 1.6em;
         padding: 10px;
         border-radius: 8px;
         margin-top: 15px;
         border: none;
         outline: none;
         background-color: var(--matrix-blue-pill);
         color: black;
         cursor: pointer;
                     filter: drop-shadow(0 0 0.35rem red);
         }
         button:hover {
         background-color: var(--matrix-amber-1);
                                  filter: drop-shadow(0 0 0.35rem var(--matrix-amber-1));
         }
           #button-AI:hover {
         background-color: var(--matrix-blue-pill);
                        filter: drop-shadow(0 0 0.85rem var(--matrix-blue-pill));
         }
           #button-GPT:hover {
         background-color: var(--matrix-red-pill);
                        filter: drop-shadow(0 0 0.85rem var(--matrix-red-pill));
         }
         .input-key {
         font-size: 1em;
         padding: 5px;
         border-radius: 10px;
         border: none;
         outline: none;
         background-color: #1f1f1f;
         color: red;
         }
         document {
         padding: 0px;
         width: 30%;
         height: 800px;
         }
         .file-list-container {
         padding: 0x;
         margin-top: 15px;
         width: 60%;
         height: 800px;
         overflow: hiden;
         }
         .container {
         display: flex;
         }
         .list-container {
         color: green;
         margin-bottom: 3%;
         }
         a {
         color: red;
         text-decoration: none;
         }
      .question {
          margin: 1% auto;
         filter: drop-shadow(0 0 0.75rem green);
          } 
         a:hover {
         color: #aaa;
         }
         .list-container, .pdf-container {
         width: 50vw;
         height: 100vh; /* Change the height value here */
         overflow: hiden;
         }
          #theme {
  padding: 1%;
  border-radius: 4px;
  border: 1px solid var(--matrix-red-1);
  outline: none;
  background-color: var(--matrix-green-1);
  color: #333;
  cursor: pointer;
}
#theme option {
  font-size: 1.2em;
  padding: 8px 12px;
  border-radius: 4px;
  border: none;
  outline: none;
  background-color: var(--matrix-green-1);;
  color: #333;
  cursor: pointer;
}
#theme option:hover {
  background-color: var(--matrix-green-1);
}
#theme:focus,
#theme:active {
  border-color: var(--matrix-red-1);
}
  #model {
  padding: 1%;
  border-radius: 4px;
  border: 1px solid var(--matrix-red-1);
  outline: none;
  background-color: var(--matrix-green-1);
  color: #333;
  cursor: pointer;
}
#model option {
  font-size: 1.2em;
  padding: 8px 12px;
  border-radius: 4px;
  border: none;
  outline: none;
  background-color: var(--matrix-green-1);;
  color: #333;
  cursor: pointer;
}
#model option:hover {
  background-color: var(--matrix-green-1);
}
#model:focus,
#model:active {
  border-color: var(--matrix-red-1);
}
 #results {
         width: 100%;
         height: 90%;
         background-color: rgba(0, 0, 0, 0.2);
         overflow-y: scroll;
         color: #00FF00;
         font-family: 'Lucida Console', monospace;
         font-size: 13px;
         font-weight: bold;
         -ms-overflow-style: none;
         scrollbar-width: none;     
          }
      </style>
   </head>
    
    
   <body onsubmit="event.preventDefault();" onclick="event.preventDefault();">
      <div class="container">
         <div class="content-wrapper">
            <canvas id="matrixCanvas"></canvas>
            <div class="left-side">
               <img src="https://s3.eu-north-1.amazonaws.com/knowledgevortex/s3/web/logo1.png" alt="KV Logo">
               <h2 id="datetime" style="color: red;"></h2>
               <h1>Knowledge Vortex to your service</h1>
               <h3>ask Operator a library related question</h3>
               <form id="ask-form" enctype="multipart/form-data" >
                   <textarea name="question" id="question" placeholder="How can I help?"required></textarea>
                   <div>
                  <button style="buttonGPT" id="button-GPT" onclick="ask_GPT(event)">ask OpenAI </button>
                  <button style="buttonAI" id="button-AI" onclick="ask_LIB(event)">ask library</button>  
                   </div>
                  <h2 for="theme">library for:</h2>
                  <div class="select-container">
                     <select name="theme" id="theme" onchange="saveTheme()">
                        <option value="coherent_chameleon">coherent_chameleon</option>
                        <option value="chameleondiscovery">ChameleonDiscovery</option>
                        <option value="innova">Innova</option>
                        <option value="powerline">Power Line</option>
                        <option value="compex">Compex</option>
                        <option value="kymera">Kymera</option>
                        <option value="newton">Newton</option>
                        <option value="zygomx">Zygo MX</option>
                        <option value="general">ChatGPTdatabase</option>
                     </select>
                  </div>
                  <div class="select-container-2" id="select-container-2">
                     <select name="model" id="model" onchange="saveModel()">
                        <option value="text-davinci-003">text-davinci-003	</option>
                        <option value="gpt-4">gpt-4</option>
                        <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
                     </select>
                  </div>
                    </form>
                  <h4 style="color: grey;"> example for ZygoMX: write script for measurement profile of metal surface using 1x zoom and 10x objective</h4>
                    <h1>Vortex keyword search</h1>
      <form id="search-form">
      <input type="text" id="keyword" name="keyword" placeholder="Enter keyword">
      <button type="button" onclick="searchFiles()">Search</button>
      </form>      
            </div>
         </div>
             
             
         <div class="right-side">
         <canvas id="matrixCanvasRight"></canvas>
         <div class="right-side"></div>
         <div id="log-container"></div>
         </div>
      </div>
          
          
          
      <div class="container">
      <div class="left-down-side">
      <div class="list-container">
      <ul>
      {% for file in files %}
      <li><a href="#" onclick="showPDF('{{ file.PresignedURL }}')">{{ file.Key }}</a></li>
      {% endfor %}
      </ul>
      </div></div>
          
          
          
      <div class="right-down-side">
      <h2>---------------------------------</h2>
      <div class="results" id="results">
      </div>  
</div></div>
          
          
      <div class="container">
      <div class="left-down-down-side">
        <form id="save_pdf">
            <h1>create New Document
        <textarea style="out_text" name="text"></textarea><br>
        <button style="button" id="button-download" onclick="save(event)">download</button>  

          </form>
 
       </div>
          
          
          
      <div class="right-down-down-side">
     
            <div class="pdf-viewer">
    <embed id="pdf-embed" src="" type="application/pdf" width="100%" height="100%">
</div>
      </div>
      </div>
          
          
          
      <div class="footer_image">
         <img src="https://s3.eu-north-1.amazonaws.com/knowledgevortex/s3/web/p6.png" alt="KV Logo">
      </div>
      <h3>Knowledge Vortex 2023</h3>
   </body>
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
   <script>
       
     
        
      function openPdf(presignedUrl) {
      console.log('Presigned URL:', presignedUrl);
      document.getElementById('pdf-container').innerHTML = `<iframe src="${presignedUrl}" style="width:100%; height:100%;" frameborder="0"></iframe>`;
      }
      
      
      function loadLogFile() {
      const logContainer = document.getElementById('log-container');
      
      fetch('/log-content')
      .then(response => response.text())
      .then(data => {
      logContainer.innerHTML = data;
      })
      .catch(error => {
      console.error('Error fetching log.txt:', error);
      });
      }
      
      loadLogFile();
             
              function saveTheme() {
       const selectedModel = document.getElementById("theme").value;
       localStorage.setItem("theme", selectedModel);
      }  
       function saveModel() {
       const selectedModel = document.getElementById("model").value;
       localStorage.setItem("model", selectedModel);
      }  
       
          
       
    async function ask_LIB(event) {
         event.preventDefault();
        const form = document.getElementById("ask-form");
        const formData = new FormData(form);
        const response =  fetch("/ask_lib", {
            method: "POST",
            body: formData,
        });
    } 
       async function ask_GPT(event) {
        event.preventDefault();   
        const form = document.getElementById("ask-form");
        const formData = new FormData(form);
        const response =  fetch("/ask_gpt", {
            method: "POST",
            body: formData,
        });     
       }  
       
       
       function save(event) {
        event.preventDefault();   
        fetch('/text_editor', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: new URLSearchParams({ text: '' }),
    })
        .then((response) => {
            if (response.ok) {
                return response.blob();
            }
            throw new Error('Network response was not ok.');
        })
        .then((blob) => {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'download.pdf';
            document.body.appendChild(a);
            a.click();
            a.remove();
        })
        .catch((error) => {
            console.error('There has been a problem with your fetch operation:', error);
        });
}
       

       
        function searchFiles() {
    const keyword = $('#keyword').val();
    $.ajax({
        url: '/search_pdf_files',
        method: 'POST',
        data: {
            keyword: keyword,
        },
        success: function(data) {
            // Render the search results
            $('.results').html(data.rendered_template);
        },
        error: function(err) {
            console.log(err);
        }
    });
}
function showPDF(url) {
    document.getElementById('pdf-embed').src = '/lurl.pdf';
    setTimeout(() => {
        document.getElementById('pdf-embed').src = url;
    }, 300);
}
        const canvas = document.getElementById('matrixCanvas');
         const ctx = canvas.getContext('2d');
         canvas.width = window.innerWidth;
         canvas.height = window.innerHeight;
         
const characters = '゠ァアィイゥウェエォオカガキギクグケゲコゴサザシジスズセゼソゾタダチヂッツヅテデトドナニヌネノハバパヒビピフブプヘベペホボポマミムメモャヤュユョヨラリルレロヮワヰヱヲンヴヵヶヷヸヹヺ・ーヽヾゝゞー１２３４５６７８９０';
         
         const fontSize = 12;
         const columns = canvas.width / fontSize;
         
         const drops = [];
         for (let i = 0; i < columns; i++) {
         	drops[i] = 1;
         }
         
         function draw() {
         	ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
         	ctx.fillRect(0, 0, canvas.width, canvas.height);
         
         	ctx.fillStyle = '#0f0';
         	ctx.font = `${fontSize}px monospace`;
         
         	for (let i = 0; i < drops.length; i++) {
         		const text = characters.charAt(Math.floor(Math.random() * characters.length));
         		ctx.fillText(text, i * fontSize, drops[i] * fontSize);
         
         		if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
         			drops[i] = 0;
         		}
         		drops[i]++;
         	}
         }
         
         setInterval(draw, 33);
   </script>    
</html>
